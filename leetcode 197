197.197. Rising Temperature
select w1.id
FROM Weather w1
JOIN Weather w2
ON DATEDIFF(w1.recordDate, w2.recordDate) = 1
WHERE w1.temperature > w2.temperature;


In SQL, rows are independent — there’s no built-in “previous row” unless we use window functions (not always available).

So we use a self-join:
w1 = today’s weather
w2 = yesterday’s weather

Now we need to make sure that:
👉 w1.recordDate is exactly 1 day after w2.recordDate.

That’s where:
DATEDIFF(w1.recordDate, w2.recordDate) = 1

comes in.
DATEDIFF(a, b) returns the number of days between a and b.
If result = 1 → w1 is exactly one day after w2.
